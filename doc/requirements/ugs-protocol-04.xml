<!-- Universal Game System Communication Protocol v.4 2011.03.07-->

<!--
'protocol' tag is here only for correctness of this file
It is not used in communication. Only single 'message' tag will be used.
XML header with xml version and encoding must appear in all messages.
-->

<!-- 

All XML data is encoded in UTF-8 without byte order mark !

-->

<protocol>

<!-- an error message which may appear from both sides as a response anytime.-->
<message type="error">
[String with error message]
</message>


<!-- Initialization messages -->
<!-- login request message from new player -->
<message type="playerLogin">
<playerLogin nick="[string]" gameType="[string]"/>
</message>

<!-- login request message from new game master -->
<message type="gameMasterLogin">
<gameMasterLogin id="[string]" gameType="[string]" playersMin="[int>1]" playersMax="[int>=playersMin]" />
</message>

<!-- login request response sent by server -->
<message type="loginResponse">
<response accept="yes/no"/>
<!--
tag present only when accept="no"
Error ids:
1 - wrong nick
2 - improper game type
3 - players pool overflow
4 - master for this game already registered
5 - wrong game type description data
-->
<error id="[int]"/>
</message>


<!-- Game messages -->

<!--
Server message with player list sent to the game master. As a response master sends gameState message with nextPlayer set to a desired first player to do a move.
-->

<message type="beginGame">
<!-- unique game identifier generated by server-->
<gameId id="[string]"/>
<!--this tag appears repeatedly for all players selected by a server-->
<player nick="[string]"/>
</message>

<!--game state message sent from the game master to the server and then by the server to all players in the game. After a game has finished server waits for
"thank you" or "error" message from all the players. -->
<message type="gameState">
<gameId id="[string]"/>
<!-- one tag of the two below appears in message -->
<nextPlayer nick="[string]"/>
<gameOver>
<!-- this tag appears repeatedly for all the players -->
<player nick="[string]" result="loser/winner"/>
</gameOver>
<!-- this tag will always appear. Not read by the server.-->
<gameState>
<!--this tag contains game-specific information in XML format
It is possible that for certain games this tag will be left empty at the begining, before the first move.
-->
</gameState>
</message>

<!--move message sent by player to server and by server to the game master as
a response to gameState message with nick pointing to that player-->

<message type="move">
<gameId id="[string]"/>
<!-- not read by server -->
<move>
<!--
this tag contains rule-specific information in XML format
-->
</move>
</message>

<!--thank you message sent by all players to the server after a game has finished. It may happen that after a game a players sends error instead of this message. -->

<message type="thank you">
<gameId id="[string]"/>
</message>


<!-- Special messages -->

<!--"leaving game" request message sent by player to server-->
<message type="leaveGame">
<gameId id="[string]"/>
</message>

<!--by this message server and game master exchange information about player that left a game-->
<message type="playerLeftGame">
<player nick="[string]"/>
<gameId id="[string]"/>
</message>

<!-- logout request from player -->
<message type="logout"/>

<!--message sent before shutting down server to all registered players and game master-->
<message type="serverShutdown"/>

<!-- Championship mode -->

<!--
server message with championship winners sent to all participants of this championship. A player may expect this kind of message anytime when not playing any game. This list is sorted according to won and then lost values
-->
<message type="championsList">
<!--this tag appears repeatedly for all registers players. This should be ordered by number of wins.-->
<player nick="[string]" won="[int]" lost="[int]"/>
</message>

</protocol>
